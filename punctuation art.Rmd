---
title: "Anna Karenina by Leo Tolstoy"
author: "Yutong Lu"
date: '2022-02-20'
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message=FALSE}
library(tidyverse)
```


```{r}
# Anna Karenina by Leo Tolstoy
text <- readLines("https://www.gutenberg.org/files/1399/1399-0.txt")[0:39819+54]
```

```{r}
library(stringi)

text <- stri_trans_general(str = text, id = "Latin-ASCII")

punc <- gsub('[a-zA-Z0-9 ]', '', text)
punc <- punc[punc != ""]
punc <- unlist(strsplit(punc, ""))
punc <- data.frame(punc)
```

```{r, fig.height=6, fig.width=6}
x <- rep(1:286, 286)
y <- rep(286:1, each=286)

blank <- data.frame(rep(" ", 392))
colnames(blank) <- "punc"
punc <- rbind(punc, blank)

matrix <- as_tibble(cbind(x,y,punc))

matrix %>% 
  ggplot(aes(x,y, label = punc)) + 
  geom_text(size = 1.5) +  
  theme_void()+
  theme(
    plot.title = element_text(size=22),
    plot.caption = element_text(size=22)) +
  labs(
    title = "Anna Karenina by Leo Tolstoy in punctuation",
    caption = "@Yutong-Lu, text source: Project Gutenberg")
```


